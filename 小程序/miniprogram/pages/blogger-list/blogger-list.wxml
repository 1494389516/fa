<!--pages/blogger-list/blogger-list.wxml-->
<view class="container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="header-content">
      <text class="page-title">æŠ–éŸ³åšä¸»</text>
      <view class="header-actions">
        <view class="refresh-btn" bindtap="onRefresh">
          <text class="icon">ğŸ”„</text>
        </view>
      </view>
    </view>
    
    <!-- æœç´¢æ  -->
    <view class="search-section">
      <view class="search-bar">
        <text class="search-icon">ğŸ”</text>
        <input 
          class="search-input" 
          placeholder="æœç´¢åšä¸»æ˜µç§°æˆ–ç®€ä»‹"
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
        />
        <text wx:if="{{searchKeyword}}" class="clear-icon" bindtap="onClearSearch">âœ•</text>
      </view>
    </view>

    <!-- ç­›é€‰æ ‡ç­¾ -->
    <view class="filter-tabs">
      <view 
        class="filter-tab {{filterType === 'all' ? 'active' : ''}}"
        data-type="all"
        bindtap="onFilterChange"
      >
        å…¨éƒ¨
      </view>
      <view 
        class="filter-tab {{filterType === 'monitoring' ? 'active' : ''}}"
        data-type="monitoring"
        bindtap="onFilterChange"
      >
        ç›‘æ§ä¸­
      </view>
      <view 
        class="filter-tab {{filterType === 'not_monitoring' ? 'active' : ''}}"
        data-type="not_monitoring"
        bindtap="onFilterChange"
      >
        æœªç›‘æ§
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-number">{{stats.total}}</text>
      <text class="stat-label">å…³æ³¨æ€»æ•°</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-number monitoring">{{stats.monitoring}}</text>
      <text class="stat-label">ç›‘æ§ä¸­</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-number not-monitoring">{{stats.notMonitoring}}</text>
      <text class="stat-label">æœªç›‘æ§</text>
    </view>
  </view>

  <!-- åšä¸»åˆ—è¡¨ -->
  <view class="blogger-list">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-state">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{bloggers.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ‘¥</view>
      <text class="empty-title">æš‚æ— å…³æ³¨çš„åšä¸»</text>
      <text class="empty-desc">è¯·å…ˆåœ¨æŠ–éŸ³å…³æ³¨ä¸€äº›åšä¸»ï¼Œç„¶ååˆ·æ–°é¡µé¢</text>
      <button class="empty-action" bindtap="onRefresh">åˆ·æ–°é¡µé¢</button>
    </view>

    <!-- åšä¸»å¡ç‰‡ -->
    <view wx:else class="blogger-cards">
      <view 
        class="blogger-card"
        wx:for="{{bloggers}}"
        wx:key="id"
        bindtap="onBloggerTap"
        data-blogger="{{item}}"
      >
        <view class="card-content">
          <!-- å¤´åƒ -->
          <view class="avatar-section">
            <image class="avatar" src="{{item.avatar}}" mode="aspectFill" />
            <view class="online-status {{item.isOnline ? 'online' : 'offline'}}"></view>
          </view>

          <!-- ä¿¡æ¯åŒºåŸŸ -->
          <view class="info-section">
            <view class="blogger-info">
              <text class="blogger-name">{{item.nickname}}</text>
              <text class="blogger-desc">{{item.signature || 'è¿™ä¸ªäººå¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡ç•™ä¸‹'}}</text>
            </view>
            
            <view class="stats-info">
              <view class="stat-item">
                <text class="stat-value">{{item.followerCount}}</text>
                <text class="stat-label">ç²‰ä¸</text>
              </view>
              <view class="stat-item">
                <text class="stat-value">{{item.videoCount}}</text>
                <text class="stat-label">ä½œå“</text>
              </view>
              <view class="stat-item">
                <text class="stat-value">{{item.newVideoCount || 0}}</text>
                <text class="stat-label">æ–°ä½œå“</text>
              </view>
            </view>
          </view>

          <!-- æ“ä½œåŒºåŸŸ -->
          <view class="action-section">
            <switch 
              class="monitor-switch"
              checked="{{item.isMonitoring}}"
              bindchange="onSwitchChange"
              data-id="{{item.id}}"
              color="#00d4ff"
            />
            <text class="switch-label">{{item.isMonitoring ? 'ç›‘æ§ä¸­' : 'æœªç›‘æ§'}}</text>
          </view>
        </view>

        <!-- æœ€æ–°è§†é¢‘é¢„è§ˆ -->
        <view wx:if="{{item.latestVideo && item.isMonitoring}}" class="latest-video">
          <text class="latest-label">æœ€æ–°:</text>
          <text class="latest-title">{{item.latestVideo.title}}</text>
          <text class="latest-time">{{item.latestVideo.publishTime}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æç¤º -->
  <view wx:if="{{!loading && bloggers.length > 0}}" class="bottom-tip">
    <text>ä¸‹æ‹‰åˆ·æ–°è·å–æœ€æ–°æ•°æ®</text>
  </view>
</view>